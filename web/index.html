<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crawl Manga</title>
    <link rel="icon" href="/favicon.ico" />
    <link rel="stylesheet" href="bootstrap-5.3.3-dist/css/bootstrap.css" />
    <script src="bootstrap-5.3.3-dist/js/bootstrap.bundle.js"></script>
    <link rel="stylesheet" href="css/main.css" />
    <!-- Include eel.js - note this file doesn't exist in the 'web' directory -->
    <script type="text/javascript" src="/eel.js"></script>
  </head>
  <body>
    <!-- Page Wrapper -->
    <div class="d-flex h-100 w-100">
      <!-- Sidebar -->
      <nav
        id="accordionSidebar"
        class="navbar-nav bg-dark bg-gradient sidebar sidebar-dark py-2 px-2"
      >
        <!-- Sidebar - Brand -->
        <div
          class="sidebar-brand d-flex align-items-center justify-content-start"
        >
          <a
            onclick="navigateToPage('dashboard')"
            class="text-decoration-none d-flex align-items-center cursor-pointer"
          >
            <i class="fas fa-desktop text-white"></i>
            <div class="sidebar-brand-text mx-3 text-white">Crawl Manga</div>
          </a>
        </div>

        <!-- Divider -->
        <hr class="sidebar-divider text-white" />

        <!-- Nav Items -->

        <div class="nav-item cursor-pointer">
          <a
            class="nav-link collapsed"
            data-bs-toggle="collapse"
            href="#collapseManga"
          >
            <i class="fas fa-fw fa-book text-white"></i>
            <span class="text-white">Manga project</span>
            <i class="fas fa-fw fa-caret-down text-white ms-auto"></i>
          </a>
          <div id="collapseManga" class="collapse">
            <div class="bg-dark py-1 collapse-inner px-2 rounded">
              <div class="nav-item">
                <a onclick="navigateToPage('download_manga')" class="nav-link">
                  <i class="fa-solid fa-book text-white"></i>
                  <span class="text-white">Download Manga</span>
                </a>
              </div>
              <div class="nav-item">
                <a onclick="navigateToPage('create_metadata')" class="nav-link">
                  <i class="fas fa-fw fa-file-code text-white"></i>
                  <span class="text-white">Create metadata</span>
                </a>
              </div>
              <div class="nav-item">
                <a onclick="navigateToPage('archive')" class="nav-link">
                  <i class="fas fa-fw fa-archive text-white"></i>
                  <span class="text-white">Archive folder</span>
                </a>
              </div>
              <div class="nav-item">
                <a onclick="navigateToPage('download_cover')" class="nav-link">
                  <i class="fas fa-fw fa-image text-white"></i>
                  <span class="text-white">Download Cover</span>
                </a>
              </div>
              <div class="nav-item">
                <a onclick="navigateToPage('resize_images')" class="nav-link">
                  <i class="fas fa-fw fa-compress text-white"></i>
                  <span class="text-white">Resize Images</span>
                </a>
              </div>
              <div class="nav-item">
                <a onclick="navigateToPage('reformat')" class="nav-link">
                  <i class="fas fa-fw fa-file text-white"></i>
                  <span class="text-white">Reformat</span>
                </a>
              </div>
              <div class="nav-item">
                <a
                  onclick="navigateToPage('move_vol_chapter')"
                  class="nav-link"
                >
                  <i class="fas fa-fw fa-exchange-alt text-white"></i>
                  <span class="text-white">Move vol/chap</span>
                </a>
              </div>
            </div>
          </div>
        </div>

        <div class="nav-item cursor-pointer">
          <a
            class="nav-link collapsed"
            data-bs-toggle="collapse"
            href="#collapseVideo"
          >
            <i class="fas fa-fw fa-video text-white"></i>
            <span class="text-white">Video project</span>
            <i class="fas fa-fw fa-caret-down text-white ms-auto"></i>
          </a>
          <div id="collapseVideo" class="collapse">
            <div class="bg-dark py-1 collapse-inner px-2 rounded">
              <div class="nav-item">
                <a onclick="navigateToPage('download_yt')" class="nav-link">
                  <i class="fas fa-fw fa-download text-white"></i>
                  <span class="text-white">Download Youtube</span>
                </a>
              </div>
              <div class="nav-item">
                <a onclick="navigateToPage('download_m3u8')" class="nav-link">
                  <i class="fas fa-fw fa-download text-white"></i>
                  <span class="text-white">Download m3u8</span>
                </a>
              </div>
              <div class="nav-item">
                <a onclick="navigateToPage('convert_ts')" class="nav-link"> 
                  <i class="fas fa-fw fa-compress text-white"></i>
                  <span class="text-white">Convert ts to mp4</span>
                </a>
              </div>
            </div>
          </div>
        </div>

        <div class="nav-item cursor-pointer">
          <a
            class="nav-link collapsed"
            data-bs-toggle="collapse"
            href="#collapseRename"
          >
            <i class="fas fa-fw fa-file-alt text-white"></i>
            <span class="text-white">Rename project</span>
            <i class="fas fa-fw fa-caret-down text-white ms-auto"></i>
          </a>
          <div id="collapseRename" class="collapse">
            <div class="bg-dark py-1 collapse-inner px-2 rounded">
              <div class="nav-item">
                <a onclick="navigateToPage('rename_files')" class="nav-link">
                  <i class="fas fa-fw fa-file-alt text-white"></i>
                  <span class="text-white">Rename files</span>
                </a>
              </div>
              <div class="nav-item">
                <a
                  onclick="navigateToPage('rename_with_file')"
                  class="nav-link"
                >
                  <i class="fas fa-fw fa-file-alt text-white"></i>
                  <span class="text-white">Rename with file</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <!-- End of Sidebar -->

      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column flex-grow-1">
        <!-- Main Content -->
        <div id="content" class="flex-grow-1"></div>
        <!-- End of Main Content -->

        <!-- Footer -->
        <footer class="sticky-footer bg-white">
          <div class="container my-auto">
            <div class="copyright text-center my-auto">
              <p class="py-2 mb-0 text-muted">
                Developed by
                <a href="https://github.com/daocaman" class="text-muted"
                  >An Đào</a
                >
              </p>
            </div>
          </div>
        </footer>

        <!-- End of Footer -->
      </div>
      <!-- End of Content Wrapper -->
    </div>
    <!-- End of Page Wrapper -->

    <!-- Loading Screen -->
    <div
      id="loadingScreen"
      class="position-fixed w-100 h-100 d-none bg-dark opacity-50"
      style="top: 0; left: 0; z-index: 9999"
    >
      <div class="d-flex justify-content-center align-items-center h-100">
        <div class="text-center">
          <img class="w-25" src="image/loading.gif" alt="Loading..." />
          <h5 class="text-white">Please wait...</h5>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div
      id="toast"
      class="toast position-fixed top-0 end-0 m-3"
      style="z-index: 9999"
      role="alert"
      aria-live="assertive"
      aria-atomic="true"
    >
      <div class="toast-header text-white" id="toastHeader">
        <strong class="me-auto" id="toastTitle"></strong>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="toast"
          aria-label="Close"
        ></button>
      </div>
      <div class="toast-body" id="toastBody"></div>
    </div>

    <script src="js/all.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Load dashboard page by default
        fetch("pages/dashboard.html")
          .then((response) => response.text())
          .then((data) => {
            document.getElementById("content").innerHTML = data;
          })
          .catch((error) => {
            console.error("Error loading dashboard:", error);
          });
      });

      function navigateToPage(page) {
        fetch(`pages/${page}.html`)
          .then((response) => response.text())
          .then((data) => {
            document.getElementById("content").innerHTML = data;
          })
          .catch((error) => {
            console.error("Error loading dashboard:", error);
          });
      }

      eel.expose(noLoadingScreen);
      function noLoadingScreen() {
        document.getElementById("loadingScreen").classList.add("d-none");
      }

      eel.expose(showMessage);
      function showMessage(title, message) {
        console.log(title, message);
        document.getElementById("toastBody").innerHTML = message;
        document.getElementById("toast").classList.add("show");
        document.getElementById("toastHeader").classList.add("bg-success");
        document.getElementById("toastTitle").innerHTML = title;
      }

      document.addEventListener("beforeunload", function () {
        eel.close_app();
      });
    </script>

    <script src="js/download_manga.js"></script>
    <script src="js/archive.js"></script>
    <script src="js/move_chapters.js"></script>
    <script src="js/create_metadata.js"></script>
    <script src="js/download_yt.js"></script>
    <script src="js/download_cover.js"></script>
    <script src="js/resize_images.js"></script>
    <script src="js/reformat.js"></script>
    <script src="js/rename_files.js"></script>
    <script src="js/rename_with_file.js"></script>
    <script src="js/download_m3u8.js"></script>
    <script src="js/convert_ts.js"></script>
  </body>
</html>
